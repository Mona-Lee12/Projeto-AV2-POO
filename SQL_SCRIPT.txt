CREATE TABLE CATEGORIA 
(
	CATEGORIA_ID INT NOT NULL AUTO_INCREMENT,
	NOME VARCHAR(100) NOT NULL,
	PRIMARY KEY (CATEGORIA_ID)
)


CREATE TABLE FUNCIONARIO (
	FUNCIONARIO_ID INT NOT NULL AUTO_INCREMENT, 
	NOME VARCHAR(500) NOT NULL,
	TELEFONE VARCHAR(13),
	CPF VARCHAR(11) NOT NULL,
	EMAIL VARCHAR(30),
	CARGO VARCHAR(50),
	SALARIO FLOAT,
	PRIMARY KEY (FUNCIONARIO_ID)
)


CREATE TABLE `PRODUTO` (
  `id` int(11) NOT NULL AUTO_INCREMENT PRIMARY KEY,
  `descricao` varchar(225) NOT NULL,
  `qtd` int(11) NOT NULL,
  `preco` decimal(10,2) NOT NULL,
  `categoria` varchar(100)NOT NULL,   
  `lote` varchar(15) NOT NULL
);


CREATE TABLE `ADMIN` (
id integer not null auto_increment primary key,
login varchar(45) not null,
senha varchar(45) not null
);

INSERT INTO ADMIN ( login, senha ) VALUES ('admin', 'admin123');

CREATE PROCEDURE `SP_BUSCAR_CATEGORIAS`(IN NOME_CATEGORIAS varchar(100))
BEGIN
    IF(NOME_CATEGORIAS = "") THEN
	SET NOME_CATEGORIAS = NULL;
    END IF;
    
    SELECT 	*
    FROM 	CATEGORIA 
    WHERE 	
    (NOME_CATEGORIAS IS NULL)
     OR 
    (NOME_CATEGORIAS IS NOT NULL AND NOME LIKE CONCAT('%',NOME_CATEGORIAS,'%'));
END

CREATE PROCEDURE `SP_BUSCAR_FUNCIONARIOS`(IN NOME_FUNCIONARIO varchar(100))
BEGIN
    IF(NOME_FUNCIONARIO = "") THEN
	SET NOME_FUNCIONARIO = NULL;
    END IF;
    
    SELECT 	*
    FROM 	FUNCIONARIO 
    WHERE 	
    (NOME_FUNCIONARIO IS NULL)
     OR 
    (NOME_FUNCIONARIO IS NOT NULL AND nome LIKE CONCAT('%',NOME_FUNCIONARIO,'%'));
END

CREATE PROCEDURE `SP_BUSCAR_PRODUTOS`(IN NOME_PRODUTO varchar(100))
BEGIN
    IF(NOME_PRODUTO = "") THEN
	SET NOME_PRODUTO = NULL;
    END IF;
    
    SELECT 	*
    FROM 	PRODUTO 
    WHERE 	
    (NOME_PRODUTO IS NULL)
     OR 
    (NOME_PRODUTO IS NOT NULL AND DESCRICAO LIKE CONCAT('%',NOME_PRODUTO,'%'));
END

CREATE PROCEDURE `SP_CADASTRAR_FUNCIONARIO`(IN NOME VARCHAR(500),IN TELEFONE VARCHAR(13),IN CPF VARCHAR(11),IN EMAIL VARCHAR(30),IN CARGO VARCHAR(50),IN SALARIO FLOAT)
BEGIN
    INSERT INTO FUNCIONARIO 
    (
	NOME,
	TELEFONE,
	EMAIL,
	CPF,
	CARGO,
	SALARIO
    )
    VALUES 
    (
	NOME,
	TELEFONE,
	EMAIL,
	CPF,
	CARGO,
	SALARIO 
    );
END


CREATE PROCEDURE `SP_CADASTRAR_PRODUTO`(IN DESCRICAO VARCHAR(225),IN QTD INT(11),IN PRECO DECIMAL(10,2),IN CATEGORIA VARCHAR(100),IN LOTE VARCHAR(15))
BEGIN
    INSERT INTO PRODUTO 
    (
    DESCRICAO,
	QTD,
	PRECO,
	CATEGORIA,
	LOTE
    )
    VALUES 
    (
    DESCRICAO,
	QTD,
	PRECO,
	CATEGORIA,
	LOTE
    );
END

CREATE PROCEDURE `SP_EDITAR_FUNCIONARIO`(IN FUNCIONARIOID INT ,IN NOME VARCHAR(500),IN TELEFONE VARCHAR(13),IN CPF VARCHAR(11),IN EMAIL VARCHAR(30),IN CARGO VARCHAR(50),IN SALARIO FLOAT)
BEGIN
    UPDATE FUNCIONARIO 
    SET 
		NOME = NOME,
		TELEFONE = TELEFONE,
		EMAIL = EMAIL,
		CPF = CPF,
		CARGO = CARGO,
		SALARIO = SALARIO
    WHERE FUNCIONARIO_ID = FUNCIONARIOID;
END

