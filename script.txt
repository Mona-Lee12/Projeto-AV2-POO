CREATE TABLE CATEGORIA 
(
	CATEGORIA_ID INT NOT NULL AUTO_INCREMENT,
	NOME VARCHAR(100) NOT NULL,
	PRIMARY KEY (CATEGORIA_ID)
)


CREATE TABLE USUARIO (
	USUARIO_ID INT NOT NULL AUTO_INCREMENT, 
	NOME VARCHAR(500) NOT NULL,
	TELEFONE VARCHAR(13),
	CPF VARCHAR(11),
	EMAIL VARCHAR(30),
	LOGIN VARCHAR(50) NOT NULL,
	SENHA VARCHAR(100) NOT NULL,
	PRIMARY KEY (USUARIO_ID)
)

INSERT INTO USUARIO (NOME,LOGIN,SENHA) VALUES ('admin','admin','admin')


CREATE PROCEDURE `SP_BUSCAR_USUARIOS`(IN NOME_USUARIO varchar(100))
BEGIN
    IF(NOME_USUARIO = "") THEN
	SET NOME_USUARIO = NULL;
    END IF;
    
    SELECT 	NOME,CPF
    FROM 	USUARIO 
    WHERE 	
    (NOME_USUARIO IS NULL)
     OR 
    (NOME_USUARIO IS NOT NULL AND nome LIKE CONCAT('%',NOME_USUARIO,'%'));
END

CREATE PROCEDURE `SP_CADASTRAR_USUARIO`(IN NOME VARCHAR(500),IN TELEFONE VARCHAR(13),IN CPF VARCHAR(11),IN EMAIL VARCHAR(30),IN LOGIN VARCHAR(50),IN SENHA VARCHAR(100))
BEGIN
    INSERT INTO USUARIO 
    (
	NOME,
	TELEFONE,
	EMAIL,
	CPF,
	LOGIN,
	SENHA
    )
    VALUES 
    (
	NOME,
	TELEFONE,
	EMAIL,
	CPF,
	LOGIN,
	SENHA 
    );
END

CREATE PROCEDURE `SP_EDITAR_USUARIO`(IN USUARIOID INT ,IN NOME VARCHAR(500),IN TELEFONE VARCHAR(13),IN CPF VARCHAR(11),IN EMAIL VARCHAR(30),IN LOGIN VARCHAR(50),IN SENHA VARCHAR(100))
BEGIN
    UPDATE USUARIO 
    SET 
		NOME = NOME,
		TELEFONE = TELEFONE,
		EMAIL = EMAIL,
		CPF = CPF,
		LOGIN = LOGIN,
		SENHA = SENHA
    WHERE USUARIO_ID = USUARIOID;
END


--- Não criar pois temos que ver a coluna de arquivo 

CREATE TABLE ARQUIVO (
	ARQUIVO_ID INT NOT NULL AUTO_INCREMENT, 
	NOME VARCHAR(500) NOT NULL,
	ASSUNTO VARCHAR(100),
	CATEGORIA_ID INT NOT NULL,
	ARQUIVO  longblob NOT NULL,
	PRIMARY KEY (USUARIO_ID)
)
